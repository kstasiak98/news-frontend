{"remainingRequest":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\src\\components\\shop\\TicketPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\src\\components\\shop\\TicketPage.vue","mtime":1592446012324},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KLy8gaW1wb3J0IHsgYXBpU2VydmljZSB9IGZyb20gIkAvY29tbW9uL2FwaS5zZXJ2aWNlIjsNCmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICJAL2NvbW1vbi9jc3JmX3Rva2VuIjsNCi8vIGltcG9ydCB7YXBpU2VydmljZX0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJUaWNrZXRQYWdlIiwNCg0KICBkYXRhOiAoKSA9PiAoew0KICAgIHJlc2VydmVkX29iamVjdF9hcnJheTogW10sDQogICAgZmlsbXNfYXJyYXk6IFtdLA0KICAgIHByaXplc19hcnJheTogW10sDQogICAgc2VsZWN0X3ZhbHVlOiBbXSwNCiAgICBudW1iZXJWYWx1ZTogMCwNCiAgICBkb2RhdGtpX251bWJlcnM6IFtdLA0KICAgIGRpYWxvZzogZmFsc2UNCiAgfSksDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5nZXRGaWxtKHRoaXMuY2FydFswXS5zZWFucy5maWxtKTsNCiAgICB0aGlzLmdldFByaXplcygpOw0KICB9LA0KICBjb21wdXRlZDogew0KICAgIHVzZXJMb2dnZWQoKSB7DQogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuaWZMb2dpbjsNCiAgICB9LA0KICAgIFVTU0VSKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJPbmxpbmU7DQogICAgfSwNCiAgICBjYXJ0KCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNhcnQ7DQogICAgfSwNCiAgICBiaWxldFR5cGUoKSB7DQogICAgICByZXR1cm4gdGhpcy5wcml6ZXNfYXJyYXkNCiAgICAgICAgLmZpbHRlcih4ID0+IHsNCiAgICAgICAgICBpZiAoeC5jZW5hX2lkID09PSAxIHx8IHguY2VuYV9pZCA9PT0gMikgcmV0dXJuIHg7DQogICAgICAgIH0pDQogICAgICAgIC5tYXAoeCA9PiB4KTsNCiAgICB9LA0KICAgIERvZGF0a2koKSB7DQogICAgICByZXR1cm4gdGhpcy5wcml6ZXNfYXJyYXkNCiAgICAgICAgLmZpbHRlcih4ID0+IHsNCiAgICAgICAgICBpZiAoeC5jZW5hX2lkID09PSAzIHx8IHguY2VuYV9pZCA9PT0gNCkgcmV0dXJuIHg7DQogICAgICAgIH0pDQogICAgICAgIC5tYXAoeCA9PiB4KTsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRQcml6ZXMoKSB7DQogICAgICBheGlvcw0KICAgICAgICAuZ2V0KGBhcGkvcHJpemVzL2AsIHsNCiAgICAgICAgICBoZWFkZXJzOiB7ICJYLUNTUkZUT0tFTiI6IENTUkZfVE9LRU4gfQ0KICAgICAgICB9KQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgdGhpcy5wcml6ZXNfYXJyYXkgPSByZXNwb25zZS5kYXRhOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGdldEZpbG0oaWQpIHsNCiAgICAgIGF4aW9zDQogICAgICAgIC5nZXQoYGFwaS9maWxtcy8ke2lkfS9gLCB7DQogICAgICAgICAgaGVhZGVyczogeyAiWC1DU1JGVE9LRU4iOiBDU1JGX1RPS0VOIH0NCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgIHRoaXMuZmlsbXNfYXJyYXkucHVzaChyZXNwb25zZS5kYXRhKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBtYWtlX29iamVjdF9hcnJheShhcnJyYXkpIHsNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJycmF5Lmxlbmd0aDsgaSArPSAxKSB7DQogICAgICAgIGlmIChhcnJyYXlbaV0gIT0gbnVsbCkgew0KICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXJycmF5W2ldLm1pZWpzY2EubGVuZ3RoOyBqICs9IDEpIHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coaikNCiAgICAgICAgICAgIGNvbnN0IERhdGEgPSB7DQogICAgICAgICAgICAgIGNsaWVudDogdGhpcy5VU1NFUi5pZCwNCiAgICAgICAgICAgICAgcm93OiBhcnJyYXlbaV0ubWllanNjYVtqXS5sYXksDQogICAgICAgICAgICAgIGNvbHVtbjogYXJycmF5W2ldLm1pZWpzY2Fbal0ubnVtYmVyLA0KICAgICAgICAgICAgICBjb2RlOiBhcnJyYXlbaV0ubWllanNjYVtqXS5jb2RlLA0KICAgICAgICAgICAgICBmaWxtTmFtZTogdGhpcy5jYXJ0WzBdLnNlYW5zLmZpbG0sDQogICAgICAgICAgICAgIHNlYW5zX2lkOiB0aGlzLmNhcnRbMF0uc2VhbnMuc2VhbnNfaWQsDQogICAgICAgICAgICAgIHRpY2t0ZXRfdHlwZTogdGhpcy5zZWxlY3RfdmFsdWVbal0ubmF6d2EsDQogICAgICAgICAgICAgIHByaXplOiB0aGlzLnByaXplc19hcnJheVswXS5jZW5hLA0KICAgICAgICAgICAgICBwcml6ZV9pZDogdGhpcy5wcml6ZXNfYXJyYXlbMF0uY2VuYV9pZCwNCiAgICAgICAgICAgICAgdGlja2V0X25hbWU6IGAke2FycnJheVtpXS5taWVqc2NhW2pdLmNvZGV9LSR7dGhpcy5zZWxlY3RfdmFsdWVbal0ubmF6d2F9YA0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKERhdGEpOw0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdF92YWx1ZSk7DQogICAgICAgICAgICAvLyB0aGlzLnJlc2VydmVkUGxhY2UoRGF0YSk7DQogICAgICAgICAgICAvLyB0aGlzLnNlbmRUaWNrZXQoRGF0YSk7DQogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2luZm9ybWF0aW9uMiIpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBhc3luYyByZXNlcnZlZFBsYWNlKERBVEEpIHsNCiAgICAgIGNvbnNvbGUubG9nKERBVEEuY29kZSk7DQogICAgICBjb25zb2xlLmxvZyhEQVRBLnNlYW5zX2lkKTsNCiAgICAgIGF4aW9zDQogICAgICAgIC5wb3N0KA0KICAgICAgICAgICJhcGkvcmVzZXJ2ZWQvIiwNCiAgICAgICAgICB7DQogICAgICAgICAgICBhZHJlc19taWVqc2NhOiBEQVRBLmNvZGUsDQogICAgICAgICAgICBzZWFuczogREFUQS5zZWFuc19pZA0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgaGVhZGVyczogeyAiWC1DU1JGVE9LRU4iOiBDU1JGX1RPS0VOIH0NCiAgICAgICAgICB9DQogICAgICAgICkNCiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgICAgfSk7DQogICAgfSwNCg0KICAgIGFzeW5jIHNlbmRUaWNrZXQoRGF0YSkgew0KICAgICAgY29uc29sZS5sb2coRGF0YS50aWNrZXRfbmFtZSk7DQogICAgICBjb25zb2xlLmxvZyhEYXRhLnNlYW5zX2lkKTsNCiAgICAgIGNvbnNvbGUubG9nKERhdGEucHJpemVfaWQpOw0KICAgICAgLy8gbGV0IGVuZHBvaW50ID0gImFwaS90aWNrZXQvIjsNCiAgICAgIC8vIGxldCBtZXRob2QgPSAiUE9TVCI7DQogICAgICAvLyBjb25zdCB0ZXN0RGF0YSA9IHsNCiAgICAgIC8vICAgY2xpZW50OiAidXNlciIsDQogICAgICAvLyAgIHJvdzogIkEiLA0KICAgICAgLy8gICBjb2x1bW46IDEwLA0KICAgICAgLy8gICBzZWFuc19uYW1lOiAxDQogICAgICAvLyB9Ow0KICAgICAgLy8gYXBpU2VydmljZShtZXRob2QsIGVuZHBvaW50LCB7DQogICAgICAvLyAgIGNsaWVudDogInVzZXIiLA0KICAgICAgLy8gICByb3c6ICJBIiwNCiAgICAgIC8vICAgY29sdW1uOiAxMCwNCiAgICAgIC8vICAgc2VhbnNfbmFtZTogMQ0KICAgICAgLy8gfSkNCiAgICAgIC8vICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAvLyAgIH0pDQogICAgICAvLyAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgew0KICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgIC8vICAgfSk7DQogICAgICBheGlvcw0KICAgICAgICAucG9zdCgNCiAgICAgICAgICAiL2FwaS90aWNrZXQvIiwNCg0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHJvZHphal9iaWxldHU6IERhdGEudGlja2V0X25hbWUsDQogICAgICAgICAgICBzZWFuczogRGF0YS5zZWFuc19pZCwNCiAgICAgICAgICAgIGNlbmE6IERhdGEucHJpemVfaWQNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIGhlYWRlcnM6IHsgIlgtQ1NSRlRPS0VOIjogQ1NSRl9UT0tFTiB9DQogICAgICAgICAgfQ0KICAgICAgICApDQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgIH0pOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["TicketPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4EA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TicketPage.vue","sourceRoot":"src/components/shop","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-row class=\"text-center\" justify=\"center\">\r\n      <v-col cols=\"12\">\r\n        <p>BILETY:</p>\r\n        <!--        SEANSA ID: {{ cart[0].seans }}<br />-->\r\n        <!--        KOSZYK: {{ cart }}<br />-->\r\n        <!--        WYBRANE FILMY: {{ films_array }}<br />-->\r\n        <!--        UZYTKOWNIK: {{ USSER }}<br />-->\r\n<!--        CENY: {{ prizes_array }}-->\r\n      </v-col>\r\n      <v-col>\r\n        <v-card v-for=\"(place, index) in cart[0].miejsca\" :key=\"index\">\r\n          <template v-if=\"place\">\r\n            <v-col cols v-for=\"(one, index1) in place.miejsca\" :key=\"index1\">\r\n              Nazwa Filmu: {{ films_array[0].tytul }} <br />\r\n              Rząd: {{ one.lay }} <br />\r\n              Miejsce: {{ one.number }} <br />\r\n              <v-col cols=\"4\" align-self=\"center\" offset=\"4\">\r\n                Typ Biletu:\r\n                <v-select\r\n                  v-model=\"select_value[index1]\"\r\n                  :items=\"biletType\"\r\n                  return-object\r\n                  item-text=\"nazwa\"\r\n                >\r\n                </v-select>\r\n              </v-col>\r\n            </v-col>\r\n          </template>\r\n        </v-card>\r\n      </v-col>\r\n    </v-row>\r\n    <v-row class=\"text-center\" justify=\"center\">\r\n            <template v-if=\"userLogged\">\r\n      <v-btn color=\"primary\" dark @click.stop=\"dialog = true\">\r\n        Dodatki\r\n      </v-btn>\r\n      <v-dialog v-model=\"dialog\" max-width=\"500\">\r\n        <v-card>\r\n          <v-card-title class=\"headline\"\r\n            >Jakie dodatki chcesz wybrać?</v-card-title\r\n          >\r\n\r\n          <v-card-text>\r\n            <v-col v-for=\"(dodatek, index) in Dodatki\" :key=\"index\">\r\n              <b>{{ dodatek.nazwa }}</b> <br />\r\n              Cena: <b>{{ dodatek.cena }} zł</b><br />\r\n              <v-text-field\r\n                v-model=\"dodatki_numbers[index]\"\r\n                type=\"number\"\r\n                label=\"Ilość:\"\r\n              />\r\n            </v-col>\r\n          </v-card-text>\r\n\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color=\"green darken-1\" text @click=\"dialog = false\">\r\n              Kup\r\n            </v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n      <v-col cols=\"12\">\r\n        <v-btn @click=\"make_object_array(cart[0].miejsca)\">ZAPALAC</v-btn>\r\n      </v-col>\r\n            </template>\r\n            <template v-else>\r\n              <h1>NAJPIERW ZALOGUJ SIE ABY ZAPŁACIĆ</h1>\r\n            </template>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n// import { apiService } from \"@/common/api.service\";\r\nimport { CSRF_TOKEN } from \"@/common/csrf_token\";\r\n// import {apiService} from \"@/common/api.service\";\r\n\r\nexport default {\r\n  name: \"TicketPage\",\r\n\r\n  data: () => ({\r\n    reserved_object_array: [],\r\n    films_array: [],\r\n    prizes_array: [],\r\n    select_value: [],\r\n    numberValue: 0,\r\n    dodatki_numbers: [],\r\n    dialog: false\r\n  }),\r\n  mounted() {\r\n    this.getFilm(this.cart[0].seans.film);\r\n    this.getPrizes();\r\n  },\r\n  computed: {\r\n    userLogged() {\r\n      return this.$store.state.ifLogin;\r\n    },\r\n    USSER() {\r\n      return this.$store.state.userOnline;\r\n    },\r\n    cart() {\r\n      return this.$store.state.cart;\r\n    },\r\n    biletType() {\r\n      return this.prizes_array\r\n        .filter(x => {\r\n          if (x.cena_id === 1 || x.cena_id === 2) return x;\r\n        })\r\n        .map(x => x);\r\n    },\r\n    Dodatki() {\r\n      return this.prizes_array\r\n        .filter(x => {\r\n          if (x.cena_id === 3 || x.cena_id === 4) return x;\r\n        })\r\n        .map(x => x);\r\n    }\r\n  },\r\n  methods: {\r\n    getPrizes() {\r\n      axios\r\n        .get(`api/prizes/`, {\r\n          headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n        })\r\n        .then(response => {\r\n          this.prizes_array = response.data;\r\n        });\r\n    },\r\n    getFilm(id) {\r\n      axios\r\n        .get(`api/films/${id}/`, {\r\n          headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n        })\r\n        .then(response => {\r\n          this.films_array.push(response.data);\r\n        });\r\n    },\r\n    make_object_array(arrray) {\r\n      for (let i = 0; i < arrray.length; i += 1) {\r\n        if (arrray[i] != null) {\r\n          for (let j = 0; j < arrray[i].miejsca.length; j += 1) {\r\n              console.log(j)\r\n            const Data = {\r\n              client: this.USSER.id,\r\n              row: arrray[i].miejsca[j].lay,\r\n              column: arrray[i].miejsca[j].number,\r\n              code: arrray[i].miejsca[j].code,\r\n              filmName: this.cart[0].seans.film,\r\n              seans_id: this.cart[0].seans.seans_id,\r\n              ticktet_type: this.select_value[j].nazwa,\r\n              prize: this.prizes_array[0].cena,\r\n              prize_id: this.prizes_array[0].cena_id,\r\n              ticket_name: `${arrray[i].miejsca[j].code}-${this.select_value[j].nazwa}`\r\n            };\r\n            console.log(Data);\r\n              console.log(this.select_value);\r\n            // this.reservedPlace(Data);\r\n            // this.sendTicket(Data);\r\n            this.$router.push(\"/information2\");\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    async reservedPlace(DATA) {\r\n      console.log(DATA.code);\r\n      console.log(DATA.seans_id);\r\n      axios\r\n        .post(\r\n          \"api/reserved/\",\r\n          {\r\n            adres_miejsca: DATA.code,\r\n            seans: DATA.seans_id\r\n          },\r\n          {\r\n            headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n          }\r\n        )\r\n        .then(function(response) {\r\n          console.log(response);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n\r\n    async sendTicket(Data) {\r\n      console.log(Data.ticket_name);\r\n      console.log(Data.seans_id);\r\n      console.log(Data.prize_id);\r\n      // let endpoint = \"api/ticket/\";\r\n      // let method = \"POST\";\r\n      // const testData = {\r\n      //   client: \"user\",\r\n      //   row: \"A\",\r\n      //   column: 10,\r\n      //   seans_name: 1\r\n      // };\r\n      // apiService(method, endpoint, {\r\n      //   client: \"user\",\r\n      //   row: \"A\",\r\n      //   column: 10,\r\n      //   seans_name: 1\r\n      // })\r\n      //   .then(function(response) {\r\n      //     console.log(response);\r\n      //   })\r\n      //   .catch(function(error) {\r\n      //     console.log(error);\r\n      //   });\r\n      axios\r\n        .post(\r\n          \"/api/ticket/\",\r\n\r\n          {\r\n            rodzaj_biletu: Data.ticket_name,\r\n            seans: Data.seans_id,\r\n            cena: Data.prize_id\r\n          },\r\n          {\r\n            headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n          }\r\n        )\r\n        .then(function(response) {\r\n          console.log(response);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n"]}]}