{"remainingRequest":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\src\\components\\shop\\TicketPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\src\\components\\shop\\TicketPage.vue","mtime":1592142459415},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\krzys\\PycharmProjects\\mysqlconnection\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KLy8gaW1wb3J0IHsgYXBpU2VydmljZSB9IGZyb20gIkAvY29tbW9uL2FwaS5zZXJ2aWNlIjsNCmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICJAL2NvbW1vbi9jc3JmX3Rva2VuIjsNCi8vIGltcG9ydCB7YXBpU2VydmljZX0gZnJvbSAiQC9jb21tb24vYXBpLnNlcnZpY2UiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJUaWNrZXRQYWdlIiwNCg0KICBkYXRhOiAoKSA9PiAoew0KICAgIHJlc2VydmVkX29iamVjdF9hcnJheTogW10sDQogICAgZmlsbXNfYXJyYXk6IFtdLA0KICAgIHByaXplc19hcnJheTogW10NCiAgfSksDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5nZXRGaWxtKHRoaXMuY2FydFswXS5zZWFucy5maWxtKTsNCiAgICB0aGlzLmdldFByaXplcygpOw0KICB9LA0KICBjb21wdXRlZDogew0KICAgIHVzZXJMb2dnZWQoKSB7DQogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuaWZMb2dpbjsNCiAgICB9LA0KICAgIFVTU0VSKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJPbmxpbmU7DQogICAgfSwNCiAgICBjYXJ0KCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNhcnQ7DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0UHJpemVzKCkgew0KICAgICAgYXhpb3MNCiAgICAgICAgLmdldChgYXBpL3ByaXplcy9gLCB7DQogICAgICAgICAgaGVhZGVyczogeyAiWC1DU1JGVE9LRU4iOiBDU1JGX1RPS0VOIH0NCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgIHRoaXMucHJpemVzX2FycmF5ID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBnZXRGaWxtKGlkKSB7DQogICAgICBheGlvcw0KICAgICAgICAuZ2V0KGBhcGkvZmlsbXMvJHtpZH0vYCwgew0KICAgICAgICAgIGhlYWRlcnM6IHsgIlgtQ1NSRlRPS0VOIjogQ1NSRl9UT0tFTiB9DQogICAgICAgIH0pDQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICB0aGlzLmZpbG1zX2FycmF5LnB1c2gocmVzcG9uc2UuZGF0YSk7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgbWFrZV9vYmplY3RfYXJyYXkoYXJycmF5KSB7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycnJheS5sZW5ndGg7IGkgKz0gMSkgew0KICAgICAgICBpZiAoYXJycmF5W2ldICE9IG51bGwpIHsNCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycnJheVtpXS5taWVqc2NhLmxlbmd0aDsgaiArPSAxKSB7DQogICAgICAgICAgICBjb25zdCBEYXRhID0gew0KICAgICAgICAgICAgICBjbGllbnQ6IHRoaXMuVVNTRVIuaWQsDQogICAgICAgICAgICAgIHJvdzogYXJycmF5W2ldLm1pZWpzY2Fbal0ubGF5LA0KICAgICAgICAgICAgICBjb2x1bW46IGFycnJheVtpXS5taWVqc2NhW2pdLm51bWJlciwNCiAgICAgICAgICAgICAgY29kZTogYXJycmF5W2ldLm1pZWpzY2Fbal0uY29kZSwNCiAgICAgICAgICAgICAgZmlsbU5hbWU6IHRoaXMuY2FydFswXS5zZWFucy5zZWFuc19maWxtLA0KICAgICAgICAgICAgICBzZWFuc19pZDogdGhpcy5jYXJ0WzBdLnNlYW5zLnNlYW5zX2lkLA0KICAgICAgICAgICAgICB0aWNrdGV0X3R5cGU6IHRoaXMucHJpemVzX2FycmF5WzBdLm5hendhLA0KICAgICAgICAgICAgICBwcml6ZTogdGhpcy5wcml6ZXNfYXJyYXlbMF0uY2VuYSwNCiAgICAgICAgICAgICAgcHJpemVfaWQ6IHRoaXMucHJpemVzX2FycmF5WzBdLmNlbmFfaWQsDQogICAgICAgICAgICAgIHRpY2tldF9uYW1lOiBgJHthcnJyYXlbaV0ubWllanNjYVtqXS5jb2RlfS0ke3RoaXMucHJpemVzX2FycmF5WzBdLm5hendhfWANCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0aGlzLnJlc2VydmVkUGxhY2UoRGF0YSk7DQogICAgICAgICAgICB0aGlzLnNlbmRUaWNrZXQoRGF0YSk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCg0KICAgIGFzeW5jIHJlc2VydmVkUGxhY2UoREFUQSkgew0KICAgICAgY29uc29sZS5sb2coREFUQS5jb2RlKTsNCiAgICAgIGNvbnNvbGUubG9nKERBVEEuc2VhbnNfaWQpOw0KICAgICAgYXhpb3MNCiAgICAgICAgLnBvc3QoDQogICAgICAgICAgImFwaS9yZXNlcnZlZC8iLA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIGFkcmVzX21pZWpzY2E6IERBVEEuY29kZSwNCiAgICAgICAgICAgIHNlYW5zOiBEQVRBLnNlYW5zX2lkDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBoZWFkZXJzOiB7ICJYLUNTUkZUT0tFTiI6IENTUkZfVE9LRU4gfQ0KICAgICAgICAgIH0NCiAgICAgICAgKQ0KICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgYXN5bmMgc2VuZFRpY2tldChEYXRhKSB7DQogICAgICBjb25zb2xlLmxvZyhEYXRhLnRpY2tldF9uYW1lKTsNCiAgICAgIGNvbnNvbGUubG9nKERhdGEuc2VhbnNfaWQpOw0KICAgICAgY29uc29sZS5sb2coRGF0YS5wcml6ZV9pZCk7DQogICAgICAvLyBsZXQgZW5kcG9pbnQgPSAiYXBpL3RpY2tldC8iOw0KICAgICAgLy8gbGV0IG1ldGhvZCA9ICJQT1NUIjsNCiAgICAgIC8vIGNvbnN0IHRlc3REYXRhID0gew0KICAgICAgLy8gICBjbGllbnQ6ICJ1c2VyIiwNCiAgICAgIC8vICAgcm93OiAiQSIsDQogICAgICAvLyAgIGNvbHVtbjogMTAsDQogICAgICAvLyAgIHNlYW5zX25hbWU6IDENCiAgICAgIC8vIH07DQogICAgICAvLyBhcGlTZXJ2aWNlKG1ldGhvZCwgZW5kcG9pbnQsIHsNCiAgICAgIC8vICAgY2xpZW50OiAidXNlciIsDQogICAgICAvLyAgIHJvdzogIkEiLA0KICAgICAgLy8gICBjb2x1bW46IDEwLA0KICAgICAgLy8gICBzZWFuc19uYW1lOiAxDQogICAgICAvLyB9KQ0KICAgICAgLy8gICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgew0KICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsNCiAgICAgIC8vICAgfSkNCiAgICAgIC8vICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7DQogICAgICAvLyAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgLy8gICB9KTsNCiAgICAgIGF4aW9zDQogICAgICAgIC5wb3N0KA0KICAgICAgICAgICIvYXBpL3RpY2tldC8iLA0KDQogICAgICAgICAgew0KICAgICAgICAgICAgcm9kemFqX2JpbGV0dTogRGF0YS50aWNrZXRfbmFtZSwNCiAgICAgICAgICAgIHNlYW5zOiBEYXRhLnNlYW5zX2lkLA0KICAgICAgICAgICAgY2VuYTogRGF0YS5wcml6ZV9pZA0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgaGVhZGVyczogeyAiWC1DU1JGVE9LRU4iOiBDU1JGX1RPS0VOIH0NCiAgICAgICAgICB9DQogICAgICAgICkNCiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgICAgfSk7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["TicketPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TicketPage.vue","sourceRoot":"src/components/shop","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-row class=\"text-center\" justify=\"center\">\r\n      <v-col cols=\"12\">\r\n        <p>BILETY:</p>\r\n        SEANSA ID: {{ cart[0].seans }}<br />\r\n        KOSZYK: {{ cart }}<br />\r\n        WYBRANE FILMY: {{ films_array }}<br />\r\n        UZYTKOWNIK: {{ USSER }}<br />\r\n        CENY: {{ prizes_array }}\r\n      </v-col>\r\n      <v-col>\r\n        <v-card v-for=\"(place, index) in cart[0].miejsca\" :key=\"index\">\r\n          <template v-if=\"place\">\r\n            <v-col cols v-for=\"(one, index1) in place.miejsca\" :key=\"index1\">\r\n              Nazwa Filmu: {{ films_array[0].tytul }} <br />\r\n              RzÄ…d: {{ one.lay }} <br />\r\n              Miejsce: {{ one.number }} <br />\r\n              BILET: {{ prizes_array[0].nazwa }}<br />\r\n            </v-col>\r\n          </template>\r\n        </v-card>\r\n      </v-col>\r\n    </v-row>\r\n    <v-row class=\"text-center\" justify=\"center\">\r\n      <template v-if=\"userLogged\">\r\n        <v-btn @click=\"make_object_array(cart[0].miejsca)\">ZAPALAC</v-btn>\r\n      </template>\r\n      <template v-else>\r\n        <h1>NAJPIERW ZALOGUJ SIE ABY ZAPLACIC</h1>\r\n      </template>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n// import { apiService } from \"@/common/api.service\";\r\nimport { CSRF_TOKEN } from \"@/common/csrf_token\";\r\n// import {apiService} from \"@/common/api.service\";\r\n\r\nexport default {\r\n  name: \"TicketPage\",\r\n\r\n  data: () => ({\r\n    reserved_object_array: [],\r\n    films_array: [],\r\n    prizes_array: []\r\n  }),\r\n  mounted() {\r\n    this.getFilm(this.cart[0].seans.film);\r\n    this.getPrizes();\r\n  },\r\n  computed: {\r\n    userLogged() {\r\n      return this.$store.state.ifLogin;\r\n    },\r\n    USSER() {\r\n      return this.$store.state.userOnline;\r\n    },\r\n    cart() {\r\n      return this.$store.state.cart;\r\n    }\r\n  },\r\n  methods: {\r\n    getPrizes() {\r\n      axios\r\n        .get(`api/prizes/`, {\r\n          headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n        })\r\n        .then(response => {\r\n          this.prizes_array = response.data;\r\n        });\r\n    },\r\n    getFilm(id) {\r\n      axios\r\n        .get(`api/films/${id}/`, {\r\n          headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n        })\r\n        .then(response => {\r\n          this.films_array.push(response.data);\r\n        });\r\n    },\r\n    make_object_array(arrray) {\r\n      for (let i = 0; i < arrray.length; i += 1) {\r\n        if (arrray[i] != null) {\r\n          for (let j = 0; j < arrray[i].miejsca.length; j += 1) {\r\n            const Data = {\r\n              client: this.USSER.id,\r\n              row: arrray[i].miejsca[j].lay,\r\n              column: arrray[i].miejsca[j].number,\r\n              code: arrray[i].miejsca[j].code,\r\n              filmName: this.cart[0].seans.seans_film,\r\n              seans_id: this.cart[0].seans.seans_id,\r\n              ticktet_type: this.prizes_array[0].nazwa,\r\n              prize: this.prizes_array[0].cena,\r\n              prize_id: this.prizes_array[0].cena_id,\r\n              ticket_name: `${arrray[i].miejsca[j].code}-${this.prizes_array[0].nazwa}`\r\n            };\r\n            this.reservedPlace(Data);\r\n            this.sendTicket(Data);\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    async reservedPlace(DATA) {\r\n      console.log(DATA.code);\r\n      console.log(DATA.seans_id);\r\n      axios\r\n        .post(\r\n          \"api/reserved/\",\r\n          {\r\n            adres_miejsca: DATA.code,\r\n            seans: DATA.seans_id\r\n          },\r\n          {\r\n            headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n          }\r\n        )\r\n        .then(function(response) {\r\n          console.log(response);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n\r\n    async sendTicket(Data) {\r\n      console.log(Data.ticket_name);\r\n      console.log(Data.seans_id);\r\n      console.log(Data.prize_id);\r\n      // let endpoint = \"api/ticket/\";\r\n      // let method = \"POST\";\r\n      // const testData = {\r\n      //   client: \"user\",\r\n      //   row: \"A\",\r\n      //   column: 10,\r\n      //   seans_name: 1\r\n      // };\r\n      // apiService(method, endpoint, {\r\n      //   client: \"user\",\r\n      //   row: \"A\",\r\n      //   column: 10,\r\n      //   seans_name: 1\r\n      // })\r\n      //   .then(function(response) {\r\n      //     console.log(response);\r\n      //   })\r\n      //   .catch(function(error) {\r\n      //     console.log(error);\r\n      //   });\r\n      axios\r\n        .post(\r\n          \"/api/ticket/\",\r\n\r\n          {\r\n            rodzaj_biletu: Data.ticket_name,\r\n            seans: Data.seans_id,\r\n            cena: Data.prize_id\r\n          },\r\n          {\r\n            headers: { \"X-CSRFTOKEN\": CSRF_TOKEN }\r\n          }\r\n        )\r\n        .then(function(response) {\r\n          console.log(response);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n"]}]}